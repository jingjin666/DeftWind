/****************************************************************************
 *
 * Copyright (c) 2018 UAVRS. All rights reserved.
 *
 ****************************************************************************/

/****************************************************************************
 * Included Files
 ****************************************************************************/


#include <dp_config.h>
#include <unistd.h>
#include <stdio.h>
#include <string.h>

#include "systemlib/perf_counter.h"


/****************************************************************************
 * Definitions
 ****************************************************************************/

/****************************************************************************
 * Private Data
 ****************************************************************************/

/****************************************************************************
 * Public Functions
 ****************************************************************************/

__EXPORT int perf_main(int argc, char *argv[]);

/****************************************************************************
 * user_start
 ****************************************************************************/

int perf_main(int argc, char *argv[])
{
	if (argc > 1) {
		if (strcmp(argv[1], "reset") == 0) {
			perf_reset_all();
			return 0;

		} else if (strcmp(argv[1], "latency") == 0) {
			perf_print_latency(1 /* stdout */);
			fflush(stdout);
			return 0;
		}

		printf("Usage: perf [reset | latency]\n");
		return -1;
	}

	perf_print_all(1 /* stdout */);
	fflush(stdout);
	return 0;
}


